Filter by:
.btn-group
  %button.btn.btn-default.dropdown-toggle{ type: 'button', data: { toggle: 'dropdown' } }
    %span#status_filter Status:All
    %span.caret
    %span.sr-only Toggle Dropdown
  %ul.dropdown-menu
    %li= link_to 'Alarm', 'javascript:void(0)', onclick: 'set_filter("Status","Alarm")'
    %li= link_to 'OK', 'javascript:void(0)', onclick: 'set_filter("Status","OK")'
    %li= link_to 'Undetermined', 'javascript:void(0)', onclick: 'set_filter("Status","Undetermined")'
    %li.divider{ role: 'separator' }
    %li= link_to 'All', 'javascript:void(0)', onclick: 'set_filter("Status","All")'

.btn-group
  %button.btn.btn-default.dropdown-toggle{ type: 'button', data: { toggle: 'dropdown' } }
    %span#severity_filter Severity:All
    %span.caret
    %span.sr-only Toggle Dropdown
  %ul.dropdown-menu
    %li= link_to 'Critical', 'javascript:void(0)', onclick: 'set_filter("Severity","Critical")'
    %li= link_to 'High', 'javascript:void(0)', onclick: 'set_filter("Severity","High")'
    %li= link_to 'Medium', 'javascript:void(0)', onclick: 'set_filter("Severity","Medium")'
    %li= link_to 'Low', 'javascript:void(0)', onclick: 'set_filter("Severity","Low")'
    %li.divider{ role: 'separator' }
    %li= link_to 'All', 'javascript:void(0)', onclick: 'set_filter("Severity","All")'

:javascript

  // set filter on start
  $(function(){ 
    severity = '#{@severity}'
    if ( severity != 'All' ) {
      set_filter('Severity','#{@severity}');
    }
    else {
      set_filter('Status','#{@state}');
    }
  });

  function set_filter(TYPE,VALUE) {
    $("#"+TYPE.toLowerCase()+"_filter").text(TYPE+":"+VALUE);
    $("#"+TYPE.toLowerCase()+"_filter").data('filter',VALUE);
    apply_filter();
  }

  function apply_filter() {
    $('#alarms_search').val('');
    alarm_severity = $('#severity_filter').data('filter') || 'All'
    alarm_status = $('#status_filter').data('filter') || 'All'
    $.ajax({ 
      url: "#{plugin('monitoring').filter_alarms_path()}",
      data: { 
        severity: alarm_severity, 
        state: alarm_status
      },
      beforeSend: function() { $('#loading').show() },
      complete: function() { $('#loading').hide() },
      dataType: 'script'
    });
  }


