= content_for :title do
  Show details for alarm #{@alarm_name}

%div{class: modal? ? 'modal-body' : ''}
  .panel-group#accordion
    .panel.panel-default
      .panel-heading
        .panel-title
          %a{href:'#collapse1', data: {toggle:'collapse', parent:'#accordion'}}
            Basic
      .panel-collapse.collapse.in#collapse1
        .panel-body
          .row
            .col-md-3.details-label
              %strong Status:
            .col-md-9.details-value= show_state(@alarm.state)
          .row
            .col-md-3.details-label
              %strong Severity:
            .col-md-9.details-value= show_severity(@alarm.severity)
          .row
            .col-md-3.details-label
              %strong Created:
            .col-md-9.details-value= @alarm.created_timestamp
          .row
            .col-md-3.details-label
              %strong Updated:
            .col-md-9.details-value= @alarm.updated_timestamp
          .row
            .col-md-3.details-label
              %strong State Updated:
            .col-md-9.details-value= @alarm.state_updated_timestamp
          .row
            .col-md-3.details-label
              %strong Latest Alarm Change:
            .col-md-9.details-value
              - if @alarm_states.empty?
                No alarm state changes found.
              - else
                - latest_alarm_state = @alarm_states[0]
                Alarm changed from #{show_state(latest_alarm_state.old_state)} to #{show_state(latest_alarm_state.new_state)} with reason: "#{latest_alarm_state.reason}"

    .panel.panel-default
      .panel-heading
        .panel-title
          %a{href:'#collapse2', data: {toggle:'collapse', parent:'#accordion'}}
            Alarm changes (
            %span{id:'count'}= @alarm_states_count
            )
          %span.loading_place
      .panel-collapse.collapse#collapse2
        .panel-body
          .row
            .col-md-12
              #alarm_states_list
                = render partial: 'alarm_states_list'
    .panel.panel-default
      .panel-heading
        .panel-title
          %a{href:'#collapse3', data: {toggle:'collapse', parent:'#accordion'}}
            Origin
            -# TODO: needs to be more compact
      .panel-collapse.collapse#collapse3
        .panel-body
          .row
            .col-md-12{id:'metrics'}
              - @alarm.metrics.each do |metric|
                .row
                  .col-md-3=metric["name"]
                  .col-md-1=icon 'arrow-right'
                  .col-md-7
                    - metric["dimensions"].each do |key, value|
                      .row
                        .col-md-3= key
                        .col-md-1=icon 'arrow-right'
                        .col-md-8=value

.buttons{class: modal? ? 'modal-footer' : ''} 
  %button.btn.btn-default{type:"button", data: { dismiss:"modal" }, aria: { label: "Got it" }} Close
