- if modal?
  = content_for :title do 
    Authorizations   
- else
  = content_for :main_toolbar do
    Authorizations
  = render partial: 'identity/projects/shared/tabs', locals: { tab: nil }  
  
  
= simple_form_for :role_assignments, url: plugin('identity').projects_members_path, method: :put, remote: request.xhr?, html: {data: {modal: modal?} } do |f|
  %div{class: modal? ? 'modal-body' : ''}
    - if current_user.is_allowed?('identity:project_member_create',{})
      .toolbar= link_to 'New Project Member', plugin('identity').new_projects_member_path, data: {modal: true}, class: 'btn btn-primary btn-sm'

    %table.table#project_members
      %thead
        %tr
          %th User
          %th Roles
          %th Actions

      %tbody
        - if @user_roles.blank?
          %tr
            %td{colspan: 3} No members assigned to this project. 
        - else    
          - can_update = current_user.is_allowed?('identity:project_member_update')
          - @user_roles.each do |user_id, values|
            = render partial: 'member', locals: {user_id: user_id, user_name: values[:name], roles: @roles, user_roles: values[:roles], can_update: can_update}
                    
  %div{class: modal? ? 'modal-footer' : ''}
    - if modal?
      %button.btn.btn-default{type:"button", data: {dismiss:"modal"}, aria: {label: "Close"}} Close
    - else
      = link_to 'Cancel', plugin('identity').projects_members_path, class: 'btn btn-default cancel stash hidden'  
    = f.submit 'Save', class: 'btn btn-primary hidden', data: { disable_with: "Please wait..." }
