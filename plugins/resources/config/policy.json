{
  /*****************************************************************************
   * All these rules expect a hash in auth_params[:selected] containing a
   * cluster_id and potentially domain_id and project_id. If you don't know
   * what to give for cluster_id, give "current".
   */

  "limes_project_scope": "%(selected.cluster_id)s == \"current\" and project_domain_id:%(selected.domain_id)s and project_id:%(selected.project_id)s",
  "limes_domain_scope": "%(selected.cluster_id)s == \"current\" and domain_id:%(selected.domain_id)s",

  "limes_cluster_editor": "role:cloud_resource_admin",
  "limes_cluster_viewer": "(role:cloud_resource_admin or role:cloud_resource_viewer)",
  "limes_domain_editor":  "rule:limes_cluster_editor or (rule:limes_domain_scope and role:resource_admin)",
  "limes_domain_viewer":  "rule:limes_cluster_viewer or (rule:limes_domain_scope and role:resource_viewer) or rule:limes_domain_editor",
  "limes_project_editor": "rule:limes_domain_editor or (rule:limes_project_scope and role:resource_admin)",
  "limes_project_viewer": "rule:limes_domain_viewer or (rule:limes_project_scope and (role:member or role:_member_ or role:Member or role:resource_viewer)) or rule:limes_project_editor",

  "project:show": "rule:limes_project_viewer",
  "project:edit": "rule:limes_project_editor",
  "domain:show": "rule:limes_domain_viewer",
  "domain:edit": "rule:limes_domain_editor",
  "cluster:show": "rule:limes_cluster_viewer",
  "cluster:edit": "rule:limes_cluster_editor"
}
